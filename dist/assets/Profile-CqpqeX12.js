import{R as h,a as J,r as a,j as e,t as g,X as E,S as K,v as X,x as Q,l as Z,m as D,i as L,s as ee,q as te,y as se,n as re}from"./index-NIf_5wet.js";import{U as le}from"./user-DlI_S5OL.js";import{L as ie}from"./log-out-C7dGcuzO.js";import{C as ne,S as H,T as y}from"./trash-2-CmbTSX_L.js";import{D as ae}from"./download-BFxrq33Z.js";import{E as U}from"./external-link-IuaWcDb-.js";var R={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},I=h.createContext&&h.createContext(R),oe=["attr","size","title"];function ce(t,r){if(t==null)return{};var l=de(t,r),i,n;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(n=0;n<c.length;n++)i=c[n],!(r.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(l[i]=t[i])}return l}function de(t,r){if(t==null)return{};var l={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(r.indexOf(i)>=0)continue;l[i]=t[i]}return l}function w(){return w=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var l=arguments[r];for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i])}return t},w.apply(this,arguments)}function A(t,r){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),l.push.apply(l,i)}return l}function j(t){for(var r=1;r<arguments.length;r++){var l=arguments[r]!=null?arguments[r]:{};r%2?A(Object(l),!0).forEach(function(i){xe(t,i,l[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):A(Object(l)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(l,i))})}return t}function xe(t,r,l){return r=he(r),r in t?Object.defineProperty(t,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[r]=l,t}function he(t){var r=me(t,"string");return typeof r=="symbol"?r:r+""}function me(t,r){if(typeof t!="object"||!t)return t;var l=t[Symbol.toPrimitive];if(l!==void 0){var i=l.call(t,r);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function F(t){return t&&t.map((r,l)=>h.createElement(r.tag,j({key:l},r.attr),F(r.child)))}function ue(t){return r=>h.createElement(be,w({attr:j({},t.attr)},r),F(t.child))}function be(t){var r=l=>{var{attr:i,size:n,title:c}=t,u=ce(t,oe),d=n||l.size||"1em",x;return l.className&&(x=l.className),t.className&&(x=(x?x+" ":"")+t.className),h.createElement("svg",w({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},l.attr,i,u,{className:x,style:j(j({color:t.color||l.color},l.style),t.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),c&&h.createElement("title",null,c),t.children)};return I!==void 0?h.createElement(I.Consumer,null,l=>r(l)):r(R)}function pe(t){return ue({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M20 2H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h3v3.767L13.277 18H20c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2zm0 14h-7.277L9 18.233V16H4V4h16v12z"},child:[]},{tag:"path",attr:{d:"M7 7h10v2H7zm0 4h7v2H7z"},child:[]}]})(t)}function ze(){const{user:t,login:r,logout:l}=J(),[i,n]=a.useState([]),[c,u]=a.useState([]),[d,x]=a.useState("recent"),[T,b]=a.useState(!1),[_,p]=a.useState(!1),[N,$]=a.useState(t?.displayName||""),[z,M]=a.useState(t?.photoURL||""),[q,f]=a.useState(!1),[m,k]=a.useState(""),[v,S]=a.useState(!1);a.useEffect(()=>{const s=JSON.parse(localStorage.getItem("recentHistory")||"[]"),o=JSON.parse(localStorage.getItem("downloadHistory")||"[]");n(s),u(o)},[]);const C=()=>{localStorage.removeItem("recentHistory"),localStorage.removeItem("downloadHistory"),n([]),u([])},B=s=>s?s.charAt(0).toUpperCase():"U",V=async s=>{s.preventDefault();try{await X(Q.currentUser,{displayName:N,photoURL:z||null}),p(!1),g.success("Profile Updated Successfully!"),window.location.reload()}catch(o){console.error("Error updating profile:",o),g.error("Error updating profile: "+o.message)}},W=async()=>{if(m.trim()){S(!0);try{await Z(D(L,"feedbacks"),{text:m,createdAt:ee(),status:"unread"});const s=te(D(L,"users"),se("role","==","admin")),o=await re(s),O=[];o.forEach(G=>{const P=G.data();P.email&&O.push(P.email)});const Y=`mailto:${O.join(",")}?subject=FYCS Study Hub Feedback&body=${encodeURIComponent(m)}`;window.location.href=Y,f(!1),k("")}catch(s){console.error("Error sending feedback:",s),g.error("Error sending feedback: "+s.message)}finally{S(!1)}}};return t?e.jsxs("div",{className:"bg-black pt-4",children:[e.jsx("div",{className:"h-25 bg-black"}),e.jsxs("div",{className:"px-5 pb-8 max-w-md mx-auto",children:[e.jsx("div",{className:"-mt-16 mb-6",children:t.photoURL?e.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-24 h-24 rounded-full border-[6px] border-zinc-900 object-cover"}):e.jsx("div",{className:"w-24 h-24 rounded-full border-[6px] border-zinc-900 bg-zinc-800 flex items-center justify-center",children:e.jsx("span",{className:"text-3xl font-bold text-white",children:B(t.displayName)})})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-1",children:t.displayName||"User"}),e.jsx("p",{className:"text-white/60 text-sm mb-4",children:t.email}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg transition-colors text-sm font-medium",children:[e.jsx(pe,{}),"Help & Feedback"]}),e.jsxs("button",{type:"button",onClick:async()=>{try{await l()}catch(s){console.error("Logout error:",s)}},className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[e.jsx(ie,{size:16}),"Sign Out"]})]})]}),e.jsxs("div",{className:"flex gap-4 mb-4 border-b border-zinc-800 overflow-x-auto whitespace-nowrap no-scrollbar pr-4",children:[e.jsx("button",{type:"button",onClick:()=>x("recent"),className:`flex-shrink-0 py-2 px-4 text-sm font-medium transition-colors whitespace-nowrap ${d==="recent"?"text-white border-b-2 border-yellow-400":"text-white/50 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{size:14}),"Recent"]})}),e.jsx("button",{type:"button",onClick:()=>x("downloads"),className:`flex-shrink-0 py-2 px-4 text-sm font-medium transition-colors whitespace-nowrap ${d==="downloads"?"text-white border-b-2 border-yellow-400":"text-white/50 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{size:14}),"Downloads"]})}),e.jsx("button",{type:"button",onClick:()=>x("settings"),className:`flex-shrink-0 py-2 px-4 text-sm font-medium transition-colors whitespace-nowrap ${d==="settings"?"text-white border-b-2 border-yellow-400":"text-white/50 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{size:14}),"Settings"]})})]}),d==="recent"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"font-bold text-lg text-white",children:"Recent"}),i.length>0&&e.jsxs("button",{type:"button",onClick:()=>b(!0),className:"text-xs text-white/50 hover:text-red-400 transition-colors flex items-center gap-1",children:[e.jsx(y,{size:14}),"Clear History"]})]}),e.jsx("div",{className:"glass-card",children:i.length===0?e.jsx("div",{className:"text-center py-8 text-zinc-400",children:"No recent history."}):e.jsx("div",{className:"divide-y divide-zinc-800 max-h-80 overflow-y-auto",children:i.map((s,o)=>e.jsxs("div",{className:"p-3 flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-zinc-800 text-gray-300 text-[10px] rounded whitespace-nowrap",children:s.subject&&s.subject.length>12?s.subject.substring(0,9)+"...":s.subject||"N/A"}),e.jsx("span",{className:"text-[10px] text-white/50",children:s.type})]}),e.jsx("h4",{className:"text-sm text-white/90 truncate",children:s.title&&s.title.length>40?s.title.substring(0,37)+"...":s.title||"Untitled"}),e.jsxs("div",{className:"text-[10px] text-zinc-400 mt-1",children:["Viewed: ",new Date(s.viewedAt).toLocaleDateString()]})]}),e.jsx("button",{type:"button",onClick:()=>window.open(s.link,"_blank","noopener,noreferrer"),className:"text-blue-400 hover:text-blue-300 transition-colors flex-shrink-0",title:"Open material",children:e.jsx(U,{size:14})})]},`${s.id}-${o}`))})})]}),d==="downloads"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg text-white",children:"Downloads"}),c.length>0&&e.jsxs("button",{type:"button",onClick:()=>b(!0),className:"text-xs text-white/50 hover:text-red-400 transition-colors flex items-center gap-1",children:[e.jsx(y,{size:14}),"Clear History"]})]}),e.jsx("div",{className:"glass-card",children:c.length===0?e.jsx("div",{className:"text-center py-8 text-zinc-400",children:"No download history."}):e.jsx("div",{className:"divide-y divide-zinc-800 max-h-80 overflow-y-auto",children:c.map((s,o)=>e.jsxs("div",{className:"p-3 flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-zinc-800 text-gray-300 text-[10px] rounded whitespace-nowrap",children:s.subject&&s.subject.length>12?s.subject.substring(0,9)+"...":s.subject||"N/A"}),e.jsx("span",{className:"text-[10px] text-white/50",children:s.type})]}),e.jsx("h4",{className:"text-sm text-white/90 truncate",children:s.title&&s.title.length>40?s.title.substring(0,37)+"...":s.title||"Untitled"}),e.jsxs("div",{className:"text-[10px] text-zinc-400 mt-1",children:["Downloaded: ",new Date(s.downloadedAt).toLocaleDateString()]})]}),e.jsx("button",{type:"button",onClick:()=>window.open(s.link,"_blank","noopener,noreferrer"),className:"text-blue-400 hover:text-blue-300 transition-colors flex-shrink-0",title:"Open material",children:e.jsx(U,{size:14})})]},`${s.id}-${o}`))})})]}),d==="settings"&&e.jsxs("div",{className:"glass-card p-6 max-w-full overflow-x-hidden",children:[e.jsx("h3",{className:"font-bold text-lg mb-6 text-white",children:"Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-800/30 rounded-lg cursor-pointer hover:bg-zinc-800/50 transition-colors",onClick:()=>p(!0),children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Edit Profile"}),e.jsx("div",{className:"text-xs text-white/50",children:"Update your profile information"})]}),e.jsx(H,{size:18,className:"text-white/50"})]}),e.jsxs("div",{className:"pt-4 border-t border-zinc-800",children:[e.jsxs("button",{type:"button",onClick:C,className:"w-full py-3 bg-red-500/20 text-red-400 border border-red-500/30 rounded-lg font-medium hover:bg-red-500/30 transition-colors flex items-center justify-center gap-2",children:[e.jsx(y,{size:16}),"Clear All Data"]}),e.jsx("p",{className:"text-xs text-white/50 mt-2 text-center",children:"This will remove all history and reset your profile"})]})]})]})]}),_&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"glass-card p-6 w-full max-w-md rounded-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Edit Profile"}),e.jsx("button",{type:"button",onClick:()=>p(!1),className:"text-white/50 hover:text-white transition-colors","aria-label":"Close edit profile modal",children:e.jsx(E,{size:24})})]}),e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/70 text-sm mb-2",children:"Display Name"}),e.jsx("input",{type:"text",value:N,onChange:s=>$(s.target.value),className:"w-full glass-card px-4 py-3 rounded-xl border border-white/10 bg-white/5 text-white placeholder:text-white/30 focus:border-blue-500 focus:outline-none",placeholder:"Enter your display name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/70 text-sm mb-2",children:"Profile Picture URL"}),e.jsx("input",{type:"url",value:z,onChange:s=>M(s.target.value),className:"w-full glass-card px-4 py-3 rounded-xl border border-white/10 bg-white/5 text-white placeholder:text-white/30 focus:border-blue-500 focus:outline-none",placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-colors",children:"Save Changes"}),e.jsx("button",{type:"button",onClick:()=>p(!1),className:"flex-1 glass-card py-3 text-center font-bold rounded-xl border border-white/10 text-white/70 hover:bg-white/5 transition-colors",children:"Cancel"})]})]})]})}),T&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-zinc-900 border border-zinc-700/50 w-full max-w-sm p-6 rounded-2xl shadow-2xl animate-in fade-in zoom-in-95 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"}),e.jsxs("div",{className:"flex flex-col items-center text-center gap-4 mt-2",children:[e.jsx("div",{className:"p-4 bg-zinc-800 rounded-full text-purple-400 mb-1 ring-1 ring-purple-500/30",children:e.jsx(K,{size:32,strokeWidth:1.5})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Time for a Fresh Start?"}),e.jsxs("p",{className:"text-zinc-400 text-sm leading-relaxed",children:["This will wipe your entire viewing history. ",e.jsx("br",{}),"It's like it never happened. âœ¨"]})]}),e.jsxs("div",{className:"flex gap-3 w-full mt-4",children:[e.jsx("button",{type:"button",onClick:()=>b(!1),className:"flex-1 px-4 py-2.5 bg-zinc-800 hover:bg-zinc-700 text-white rounded-xl transition-all font-medium border border-zinc-700",children:"Nah, keep it"}),e.jsx("button",{type:"button",onClick:()=>{C(),b(!1)},className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 text-white rounded-xl transition-all font-bold shadow-lg shadow-purple-500/20",children:"Yes, Clear All"})]})]})]})}),q&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-zinc-900 border border-zinc-700/50 w-full max-w-md p-6 rounded-2xl shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Send Feedback"}),e.jsx("button",{type:"button",onClick:()=>f(!1),className:"text-white/50 hover:text-white transition-colors","aria-label":"Close feedback modal",children:e.jsx(E,{size:24})})]}),e.jsx("textarea",{value:m,onChange:s=>k(s.target.value),placeholder:"Enter your feedback here...",className:"w-full h-40 p-3 bg-zinc-800 text-white rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-yellow-400 resize-none"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>f(!1),disabled:v,className:"flex-1 px-4 py-2.5 bg-zinc-800 hover:bg-zinc-700 text-white rounded-xl transition-all font-medium border border-zinc-700 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:W,disabled:v||!m.trim(),className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-400 hover:to-yellow-500 text-black rounded-xl transition-all font-bold shadow-lg shadow-yellow-500/20 disabled:opacity-50",children:v?"Sending...":"Send to Admins"})]})]})]})})]}):e.jsx("div",{className:"p-5 pt-4 max-w-md mx-auto",children:e.jsxs("div",{className:"glass-card p-8 text-center",children:[e.jsx(le,{size:48,className:"mx-auto mb-4 text-white/30"}),e.jsx("div",{className:"font-bold text-lg mb-2",children:"Please Login"}),e.jsx("div",{className:"text-white/55 text-sm mb-6",children:"You need to be logged in to view your profile."}),e.jsxs("button",{type:"button",onClick:async()=>{try{await r()}catch(s){console.error("Login error:",s),g.error("Login failed. Please try again.")}},className:"w-full py-3 rounded-xl bg-white/10 text-white font-bold flex items-center justify-center gap-2 hover:bg-white/20 border border-white/20 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M21.35 11.1h-9.17v2.73h6.51c-.33 1.76-1.77 3.12-3.77 3.12-2.29 0-4.14-1.86-4.14-4.15s1.85-4.15 4.14-4.15c1.11 0 2.08.41 2.81 1.19l2.06-2.06c-1.27-1.19-2.88-1.92-4.87-1.92-4.02 0-7.29 3.27-7.29 7.29s3.27 7.29 7.29 7.29c3.68 0 6.74-2.69 6.74-7.29 0-.58-.1-1.14-.2-1.67z"})}),"Sign in with Google"]})]})})}export{ze as default};
