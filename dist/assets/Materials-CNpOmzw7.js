import{b as k,l as F,m as z,r as c,j as e,g as P,n as $,h as I,A as T,i as L}from"./vendor-react-DTJB9r93.js";import{u as E}from"./index-ba0X72c2.js";import{M as Q}from"./MaterialCard-BDkd7TR5.js";import"./vendor-BigPqmVK.js";import"./vendor-firebase-B7eFefMy.js";const q=n=>{if(!n)return"";const r=n.match(/\/d\/(.+?)\/|id=(.+?)(\&|$)/),o=r?r[1]||r[2]:null;return o?`https://docs.google.com/uc?export=download&id=${o}`:n};function K(){const n=k(),{semId:r,subjectId:o}=F(),[w]=z(),{getSemesterById:v,getSubjectById:m,getMaterialsBySubject:N,incrementView:O}=E(),u=v(r),x=m(o),g=w.get("tab")||"notes",y={notes:"Notes",practicals:"Practicals",imp:"IMP",assignment:"Assignment"}[g.toLowerCase()]||"Notes",[i,A]=c.useState(y),[l,S]=c.useState(""),[d,D]=c.useState("a-z"),[h,p]=c.useState(!1),b=N(o)||[],f=c.useMemo(()=>b.filter(t=>t.status==="Approved"),[b]),j=c.useMemo(()=>{let t=[...f];if(t=t.filter(s=>s.type===i),l){const s=l.toLowerCase();t=t.filter(a=>a.title.toLowerCase().includes(s))}return t.sort((s,a)=>{switch(d){case"newest":const M=s.createdAt?.toDate?s.createdAt.toDate():new Date(s.createdAt||s.date||0);return(a.createdAt?.toDate?a.createdAt.toDate():new Date(a.createdAt||a.date||0))-M;case"oldest":const C=s.createdAt?.toDate?s.createdAt.toDate():new Date(s.createdAt||s.date||0),B=a.createdAt?.toDate?a.createdAt.toDate():new Date(a.createdAt||a.date||0);return C-B;case"a-z":return s.title.localeCompare(a.title);default:return 0}}),t},[f,i,l,d]);return!u||!x?e.jsx("div",{className:"p-5 pt-8 max-w-md mx-auto",children:e.jsxs("div",{className:"glass-card p-4",children:[e.jsx("div",{className:"font-semibold",children:"Subject not found"}),e.jsx("div",{className:"text-[11px] text-white/55 mt-1",children:"Please go back and choose a valid subject."}),e.jsx("button",{type:"button",className:"btn-primary w-full mt-4",onClick:()=>n(`/semester/${r}`),children:"Back to Subjects"})]})}):e.jsxs("div",{className:"p-5 pt-6 max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx(P,{to:`/semester/${u.id}`,className:"glass-card h-10 w-10 flex items-center justify-center hover:bg-white/10 transition-colors","aria-label":"Back",title:"Back",children:e.jsx($,{size:18,className:"text-white/80"})}),e.jsxs("div",{className:"text-center min-w-0 px-2",children:[e.jsx("div",{className:"text-[11px] text-white/55 truncate",children:u.name}),e.jsx("div",{className:"font-bold truncate",children:x.name})]}),e.jsx("div",{className:"w-10"})]}),e.jsx("div",{className:"glass-card p-2 mb-4 rounded-full",children:e.jsx("div",{className:"flex gap-2",children:["Notes","Practicals","IMP","Assignment"].map(t=>{const s=i===t;return e.jsx("button",{type:"button",onClick:()=>A(t),className:["flex-1 rounded-full py-2 text-[11px] font-extrabold transition-colors",s?"bg-[#FFD700] text-black":"text-white/70 hover:bg-white/5"].join(" "),children:t},t)})})}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(I,{size:16,className:"text-white/50"})}),e.jsx("input",{type:"text",value:l,onChange:t=>S(t.target.value),placeholder:"Search notes, practicals...",className:"w-full glass-card pl-10 pr-4 py-2 rounded-xl border border-white/10 bg-zinc-800 text-white placeholder:text-white/30 focus:border-[#FFD700] focus:outline-none"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",onClick:()=>p(!h),className:"glass-card w-12 h-12 rounded-xl flex items-center justify-center hover:bg-white/10 transition-colors border border-white/10",title:"Sort materials",children:e.jsx(T,{size:18,className:"text-white/80"})}),h&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 glass-card rounded-xl border border-white/10 z-10",children:e.jsx("div",{className:"py-2",children:[{value:"newest",label:"Newest First"},{value:"oldest",label:"Oldest First"},{value:"a-z",label:"Title A-Z"}].map(t=>e.jsxs("button",{type:"button",onClick:()=>{D(t.value),p(!1)},className:`w-full px-4 py-2 text-left text-sm flex items-center justify-between hover:bg-white/5 transition-colors ${d===t.value?"text-[#FFD700] font-bold":"text-white"}`,children:[t.label,d===t.value&&e.jsx(L,{size:16})]},t.value))})})]})]}),e.jsxs("div",{className:"space-y-3",children:[j.map(t=>e.jsx(Q,{material:t,convertToDownloadLink:q,getSubjectById:m},t.id)),j.length?null:e.jsx("div",{className:"glass-card p-4 text-center text-white/60 text-sm",children:l?`No ${i} found matching "${l}"`:`No ${i} found for this subject.`})]})]})}export{K as default};
