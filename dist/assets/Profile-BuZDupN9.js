import{r as s,j as e,U as q,O as d,a0 as Y,w as B,z as J,D as _,$ as z,x as u,E as S,X as C,S as G}from"./vendor-react-C85kPXhq.js";import{u as V,b as W,d as E}from"./index-CM_2e7_B.js";import{t as X,h as K,c as D,k as Q,q as Z,w as ee,l as te}from"./vendor-firebase-B7eFefMy.js";import"./vendor-BigPqmVK.js";function ne(){const{user:a,login:U,logout:L}=V(),[x,p]=s.useState([]),[h,f]=s.useState([]),[r,m]=s.useState("recent"),[P,n]=s.useState(!1),[A,o]=s.useState(!1),[w,H]=s.useState(a?.displayName||""),[g,F]=s.useState(a?.photoURL||""),[I,c]=s.useState(!1),[i,j]=s.useState(""),[b,v]=s.useState(!1);s.useEffect(()=>{const t=JSON.parse(localStorage.getItem("recentHistory")||"[]"),l=JSON.parse(localStorage.getItem("downloadHistory")||"[]");p(t),f(l)},[]);const N=()=>{localStorage.removeItem("recentHistory"),localStorage.removeItem("downloadHistory"),p([]),f([])},R=t=>t?t.charAt(0).toUpperCase():"U",$=async t=>{t.preventDefault();try{await X(W.currentUser,{displayName:w,photoURL:g||null}),o(!1),d.success("Profile Updated Successfully!"),window.location.reload()}catch(l){console.error("Error updating profile:",l),d.error("Error updating profile: "+l.message)}},O=async()=>{if(i.trim()){v(!0);try{await K(D(E,"feedbacks"),{text:i,createdAt:Q(),status:"unread"});const t=Z(D(E,"users"),ee("role","==","admin")),l=await te(t),y=[];l.forEach(M=>{const k=M.data();k.email&&y.push(k.email)});const T=`mailto:${y.join(",")}?subject=FYCS Study Hub Feedback&body=${encodeURIComponent(i)}`;window.location.href=T,c(!1),j("")}catch(t){console.error("Error sending feedback:",t),d.error("Error sending feedback: "+t.message)}finally{v(!1)}}};return a?e.jsxs("div",{className:"bg-black pt-4",children:[e.jsx("div",{className:"h-25 bg-black"}),e.jsxs("div",{className:"px-5 pb-8 max-w-md mx-auto",children:[e.jsx("div",{className:"-mt-16 mb-6",children:a.photoURL?e.jsx("img",{src:a.photoURL,alt:a.displayName,className:"w-24 h-24 rounded-full border-[6px] border-zinc-900 object-cover"}):e.jsx("div",{className:"w-24 h-24 rounded-full border-[6px] border-zinc-900 bg-zinc-800 flex items-center justify-center",children:e.jsx("span",{className:"text-3xl font-bold text-white",children:R(a.displayName)})})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-1",children:a.displayName||"User"}),e.jsx("p",{className:"text-white/60 text-sm mb-4",children:a.email}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg transition-colors text-sm font-medium",children:[e.jsx(Y,{}),"Help & Feedback"]}),e.jsxs("button",{type:"button",onClick:async()=>{try{await L()}catch(t){console.error("Logout error:",t)}},className:"px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[e.jsx(B,{size:16}),"Sign Out"]})]})]}),e.jsxs("div",{className:"flex gap-4 mb-4 border-b border-zinc-800 overflow-x-auto whitespace-nowrap no-scrollbar pr-4",children:[e.jsx("button",{type:"button",onClick:()=>m("recent"),className:`flex-shrink-0 py-2 px-4 text-sm font-medium transition-colors whitespace-nowrap ${r==="recent"?"text-white border-b-2 border-yellow-400":"text-white/50 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{size:14}),"Recent"]})}),e.jsx("button",{type:"button",onClick:()=>m("downloads"),className:`flex-shrink-0 py-2 px-4 text-sm font-medium transition-colors whitespace-nowrap ${r==="downloads"?"text-white border-b-2 border-yellow-400":"text-white/50 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{size:14}),"Downloads"]})}),e.jsx("button",{type:"button",onClick:()=>m("settings"),className:`flex-shrink-0 py-2 px-4 text-sm font-medium transition-colors whitespace-nowrap ${r==="settings"?"text-white border-b-2 border-yellow-400":"text-white/50 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{size:14}),"Settings"]})})]}),r==="recent"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"font-bold text-lg text-white",children:"Recent"}),x.length>0&&e.jsxs("button",{type:"button",onClick:()=>n(!0),className:"text-xs text-white/50 hover:text-red-400 transition-colors flex items-center gap-1",children:[e.jsx(u,{size:14}),"Clear History"]})]}),e.jsx("div",{className:"glass-card",children:x.length===0?e.jsx("div",{className:"text-center py-8 text-zinc-400",children:"No recent history."}):e.jsx("div",{className:"divide-y divide-zinc-800 max-h-80 overflow-y-auto",children:x.map((t,l)=>e.jsxs("div",{className:"p-3 flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-zinc-800 text-gray-300 text-[10px] rounded whitespace-nowrap",children:t.subject&&t.subject.length>12?t.subject.substring(0,9)+"...":t.subject||"N/A"}),e.jsx("span",{className:"text-[10px] text-white/50",children:t.type})]}),e.jsx("h4",{className:"text-sm text-white/90 truncate",children:t.title&&t.title.length>40?t.title.substring(0,37)+"...":t.title||"Untitled"}),e.jsxs("div",{className:"text-[10px] text-zinc-400 mt-1",children:["Viewed: ",new Date(t.viewedAt).toLocaleDateString()]})]}),e.jsx("button",{type:"button",onClick:()=>window.open(t.link,"_blank","noopener,noreferrer"),className:"text-blue-400 hover:text-blue-300 transition-colors flex-shrink-0",title:"Open material",children:e.jsx(S,{size:14})})]},`${t.id}-${l}`))})})]}),r==="downloads"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-lg text-white",children:"Downloads"}),h.length>0&&e.jsxs("button",{type:"button",onClick:()=>n(!0),className:"text-xs text-white/50 hover:text-red-400 transition-colors flex items-center gap-1",children:[e.jsx(u,{size:14}),"Clear History"]})]}),e.jsx("div",{className:"glass-card",children:h.length===0?e.jsx("div",{className:"text-center py-8 text-zinc-400",children:"No download history."}):e.jsx("div",{className:"divide-y divide-zinc-800 max-h-80 overflow-y-auto",children:h.map((t,l)=>e.jsxs("div",{className:"p-3 flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-1.5 py-0.5 bg-zinc-800 text-gray-300 text-[10px] rounded whitespace-nowrap",children:t.subject&&t.subject.length>12?t.subject.substring(0,9)+"...":t.subject||"N/A"}),e.jsx("span",{className:"text-[10px] text-white/50",children:t.type})]}),e.jsx("h4",{className:"text-sm text-white/90 truncate",children:t.title&&t.title.length>40?t.title.substring(0,37)+"...":t.title||"Untitled"}),e.jsxs("div",{className:"text-[10px] text-zinc-400 mt-1",children:["Downloaded: ",new Date(t.downloadedAt).toLocaleDateString()]})]}),e.jsx("button",{type:"button",onClick:()=>window.open(t.link,"_blank","noopener,noreferrer"),className:"text-blue-400 hover:text-blue-300 transition-colors flex-shrink-0",title:"Open material",children:e.jsx(S,{size:14})})]},`${t.id}-${l}`))})})]}),r==="settings"&&e.jsxs("div",{className:"glass-card p-6 max-w-full overflow-x-hidden",children:[e.jsx("h3",{className:"font-bold text-lg mb-6 text-white",children:"Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-800/30 rounded-lg cursor-pointer hover:bg-zinc-800/50 transition-colors",onClick:()=>o(!0),children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:"Edit Profile"}),e.jsx("div",{className:"text-xs text-white/50",children:"Update your profile information"})]}),e.jsx(z,{size:18,className:"text-white/50"})]}),e.jsxs("div",{className:"pt-4 border-t border-zinc-800",children:[e.jsxs("button",{type:"button",onClick:N,className:"w-full py-3 bg-red-500/20 text-red-400 border border-red-500/30 rounded-lg font-medium hover:bg-red-500/30 transition-colors flex items-center justify-center gap-2",children:[e.jsx(u,{size:16}),"Clear All Data"]}),e.jsx("p",{className:"text-xs text-white/50 mt-2 text-center",children:"This will remove all history and reset your profile"})]})]})]})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"glass-card p-6 w-full max-w-md rounded-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Edit Profile"}),e.jsx("button",{type:"button",onClick:()=>o(!1),className:"text-white/50 hover:text-white transition-colors","aria-label":"Close edit profile modal",children:e.jsx(C,{size:24})})]}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/70 text-sm mb-2",children:"Display Name"}),e.jsx("input",{type:"text",value:w,onChange:t=>H(t.target.value),className:"w-full glass-card px-4 py-3 rounded-xl border border-white/10 bg-white/5 text-white placeholder:text-white/30 focus:border-blue-500 focus:outline-none",placeholder:"Enter your display name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white/70 text-sm mb-2",children:"Profile Picture URL"}),e.jsx("input",{type:"url",value:g,onChange:t=>F(t.target.value),className:"w-full glass-card px-4 py-3 rounded-xl border border-white/10 bg-white/5 text-white placeholder:text-white/30 focus:border-blue-500 focus:outline-none",placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-colors",children:"Save Changes"}),e.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 glass-card py-3 text-center font-bold rounded-xl border border-white/10 text-white/70 hover:bg-white/5 transition-colors",children:"Cancel"})]})]})]})}),P&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-zinc-900 border border-zinc-700/50 w-full max-w-sm p-6 rounded-2xl shadow-2xl animate-in fade-in zoom-in-95 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"}),e.jsxs("div",{className:"flex flex-col items-center text-center gap-4 mt-2",children:[e.jsx("div",{className:"p-4 bg-zinc-800 rounded-full text-purple-400 mb-1 ring-1 ring-purple-500/30",children:e.jsx(G,{size:32,strokeWidth:1.5})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Time for a Fresh Start?"}),e.jsxs("p",{className:"text-zinc-400 text-sm leading-relaxed",children:["This will wipe your entire viewing history. ",e.jsx("br",{}),"It's like it never happened. âœ¨"]})]}),e.jsxs("div",{className:"flex gap-3 w-full mt-4",children:[e.jsx("button",{type:"button",onClick:()=>n(!1),className:"flex-1 px-4 py-2.5 bg-zinc-800 hover:bg-zinc-700 text-white rounded-xl transition-all font-medium border border-zinc-700",children:"Nah, keep it"}),e.jsx("button",{type:"button",onClick:()=>{N(),n(!1)},className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 text-white rounded-xl transition-all font-bold shadow-lg shadow-purple-500/20",children:"Yes, Clear All"})]})]})]})}),I&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-zinc-900 border border-zinc-700/50 w-full max-w-md p-6 rounded-2xl shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Send Feedback"}),e.jsx("button",{type:"button",onClick:()=>c(!1),className:"text-white/50 hover:text-white transition-colors","aria-label":"Close feedback modal",children:e.jsx(C,{size:24})})]}),e.jsx("textarea",{value:i,onChange:t=>j(t.target.value),placeholder:"Enter your feedback here...",className:"w-full h-40 p-3 bg-zinc-800 text-white rounded border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-yellow-400 resize-none"}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),disabled:b,className:"flex-1 px-4 py-2.5 bg-zinc-800 hover:bg-zinc-700 text-white rounded-xl transition-all font-medium border border-zinc-700 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:O,disabled:b||!i.trim(),className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-400 hover:to-yellow-500 text-black rounded-xl transition-all font-bold shadow-lg shadow-yellow-500/20 disabled:opacity-50",children:b?"Sending...":"Send to Admins"})]})]})]})})]}):e.jsx("div",{className:"p-5 pt-4 max-w-md mx-auto",children:e.jsxs("div",{className:"glass-card p-8 text-center",children:[e.jsx(q,{size:48,className:"mx-auto mb-4 text-white/30"}),e.jsx("div",{className:"font-bold text-lg mb-2",children:"Please Login"}),e.jsx("div",{className:"text-white/55 text-sm mb-6",children:"You need to be logged in to view your profile."}),e.jsxs("button",{type:"button",onClick:async()=>{try{await U()}catch(t){console.error("Login error:",t),d.error("Login failed. Please try again.")}},className:"w-full py-3 rounded-xl bg-white/10 text-white font-bold flex items-center justify-center gap-2 hover:bg-white/20 border border-white/20 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M21.35 11.1h-9.17v2.73h6.51c-.33 1.76-1.77 3.12-3.77 3.12-2.29 0-4.14-1.86-4.14-4.15s1.85-4.15 4.14-4.15c1.11 0 2.08.41 2.81 1.19l2.06-2.06c-1.27-1.19-2.88-1.92-4.87-1.92-4.02 0-7.29 3.27-7.29 7.29s3.27 7.29 7.29 7.29c3.68 0 6.74-2.69 6.74-7.29 0-.58-.1-1.14-.2-1.67z"})}),"Sign in with Google"]})]})})}export{ne as default};
